"use strict";(self["webpackChunktest1"]=self["webpackChunktest1"]||[]).push([[419],{9946:function(e,t,a){a.d(t,{Z:function(){return C}});var o=a(6252),s=a(3577);const l={class:"modal fade",id:"couponModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},n={class:"modal-dialog"},i={class:"modal-content"},d={class:"modal-header bg-danger"},p={class:"modal-title text-white",id:"staticBackdropLabel"},c=(0,o._)("input",{type:"button",value:"✕",class:"bg-transparent border-0 text-white","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),u={class:"modal-body"},r={class:"modal-footer"},m=(0,o._)("button",{type:"button",class:"btn btn-outline-primary","data-bs-dismiss":"modal"},"取消",-1);function h(e,t,a,h,_,b){return(0,o.wg)(),(0,o.iD)("div",l,[(0,o._)("div",n,[(0,o._)("div",i,[(0,o._)("div",d,[(0,o._)("h5",p,"刪除"+(0,s.zw)(a.item.title),1),c]),(0,o._)("div",u," 確認要刪除"+(0,s.zw)(a.item.title)+"嗎？ ",1),(0,o._)("div",r,[m,(0,o._)("button",{type:"button",class:"btn btn-danger text-white",onClick:t[0]||(t[0]=t=>e.$emit("delete-item"))},"確認")])])])],512)}var _=a(7995),b={props:{item:{}},emits:["delete-item"],data(){return{modal:{}}},mixins:[_.Z]},g=a(3744);const f=(0,g.Z)(b,[["render",h]]);var C=f},2816:function(e,t,a){a.d(t,{Z:function(){return b}});var o=a(6252),s=a(3577),l=a(9963);const n={class:"pagination justify-content-center"},i=(0,o._)("span",{"aria-hidden":"true"},"⇠",-1),d=[i],p=["onClick"],c=(0,o._)("span",{"aria-hidden":"true"},"⇢",-1),u=[c];function r(e,t,a,i,c,r){return(0,o.wg)(),(0,o.iD)("ul",n,[(0,o._)("li",{class:(0,s.C_)(["page-item fs-3",{"d-none":!a.pages.has_pre}])},[(0,o._)("a",{class:"pages-next-link",href:"#",onClick:t[0]||(t[0]=(0,l.iM)((e=>r.updatedPage(a.pages.current_page-1)),["prevent"]))},d)],2),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.pages.total_pages,(e=>((0,o.wg)(),(0,o.iD)("li",{class:(0,s.C_)(["page-item fs-3",{active:a.pages.current_page===e}]),key:e},[(0,o._)("a",{class:"pages-link",href:"#",onClick:(0,l.iM)((t=>r.updatedPage(e)),["prevent"])},(0,s.zw)(e),9,p)],2)))),128)),(0,o._)("li",{class:(0,s.C_)(["page-item fs-3",{"d-none":!a.pages.has_next}])},[(0,o._)("a",{class:"pages-next-link",href:"#",onClick:t[1]||(t[1]=(0,l.iM)((e=>r.updatedPage(a.pages.current_page+1)),["prevent"]))},u)],2)])}var m={props:["pages"],methods:{updatedPage(e){this.$emit("change-page",e)}}},h=a(3744);const _=(0,h.Z)(m,[["render",r]]);var b=_},2419:function(e,t,a){a.r(t),a.d(t,{default:function(){return pe}});var o=a(6252),s=a(3577),l=a(9963);const n={key:0,class:"position-absolute top-50 start-50 translate-middle fs-1"},i={class:"d-none d-md-table table mt-8 mt-md-10"},d=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",null,"名稱"),(0,o._)("th",null,"代碼"),(0,o._)("th",null,"折扣百分比"),(0,o._)("th",null,"到期日"),(0,o._)("th",{class:"text-center"},"啟用"),(0,o._)("th")])],-1),p={class:"text-center"},c={key:0,class:"text-success"},u={key:1,class:"text-danger"},r={class:"text-end"},m=["onClick"],h=["onClick"],_={class:"position-relative"},b={class:"position-absolute end-0",style:{top:".5rem"}},g={key:0,class:"text-success fs-1 pe-3 bi bi-check2-circle"},f={key:1,class:"text-danger fs-1 pe-3 bi bi-x-circle"},C={class:"card-body px-0 pb-0"},v={class:"card-title d-flex justify-content-between px-3 mb-3"},w={class:"card-text px-3"},k=(0,o._)("span",null,"折扣代碼：",-1),x=(0,o._)("span",null,"有效日期：",-1),y=(0,o._)("span",null,"折扣百分比：",-1),M={class:"border-top border-1"},D=["onClick"],$=["onClick"],V=(0,o._)("i",{class:"bi bi-plus-circle"},null,-1),z=[V];function W(e,t,a,V,W,U){const Z=(0,o.up)("LoadingView"),L=(0,o.up)("coupon-modal"),P=(0,o.up)("delete-modal"),Y=(0,o.up)("pagination");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(Z,{active:W.isLoading},null,8,["active"]),0===W.coupons.length?((0,o.wg)(),(0,o.iD)("div",n,"目前無優惠卷")):((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[(0,o._)("table",i,[d,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(W.coupons,(t=>((0,o.wg)(),(0,o.iD)("tr",{key:t.id},[(0,o._)("td",null,(0,s.zw)(t.title),1),(0,o._)("td",null,(0,s.zw)(t.code),1),(0,o._)("td",null,(0,s.zw)(t.percent)+"%",1),(0,o._)("td",null,(0,s.zw)(e.$filters.date(t.due_date)),1),(0,o._)("td",p,[1===t.is_enabled?((0,o.wg)(),(0,o.iD)("span",c,"YES")):((0,o.wg)(),(0,o.iD)("span",u,"NO"))]),(0,o._)("td",r,[(0,o._)("i",{class:"bi bi-pencil pointer me-1 me-md-4",onClick:e=>U.openModal("edit",t)},null,8,m),(0,o._)("i",{class:"bi bi-trash pointer",onClick:e=>U.openModal("delete",t)},null,8,h)])])))),128))])]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(W.coupons,(t=>((0,o.wg)(),(0,o.iD)("div",{class:"card mb-4 d-md-none",key:t},[(0,o._)("div",_,[(0,o._)("div",b,[t.is_enabled?((0,o.wg)(),(0,o.iD)("span",g)):((0,o.wg)(),(0,o.iD)("span",f))])]),(0,o._)("div",C,[(0,o._)("h5",v,(0,s.zw)(t.title),1),(0,o._)("div",w,[(0,o._)("p",null,[k,(0,o._)("span",null,(0,s.zw)(t.code),1)]),(0,o._)("p",null,[x,(0,o._)("span",null,(0,s.zw)(e.$filters.date(t.due_date)),1)]),(0,o._)("p",null,[y,(0,o._)("span",null,(0,s.zw)(t.percent)+"%",1)])]),(0,o._)("div",M,[(0,o._)("button",{class:"coupons-phoneSize-edit-btn col-6 border-0 border-end py-2 text-success",onClick:e=>U.openModal("edit",t)}," 編輯 ",8,D),(0,o._)("button",{class:"coupons-phoneSize-edit-btn col-6 border-0 py-2 text-danger",onClick:e=>U.openModal("delete",t)}," 刪除 ",8,$)])])])))),128))],64)),(0,o._)("button",{class:"icon-btn position-fixed bottom-15 end-5","data-bs-toggle":"tooltip","data-bs-placement":"top",title:"新增",ref:"tooltip",onClick:t[0]||(t[0]=(0,l.iM)((e=>U.openModal("add")),["prevent"]))},z,512),(0,o.Wm)(L,{ref:"showCouponModal",coupon:W.tempCoupon,onAddCoupon:U.updateCoupon},null,8,["coupon","onAddCoupon"]),(0,o.Wm)(P,{ref:"showDeleteModal",item:W.tempCoupon,onDeleteItem:U.deleteCoupon},null,8,["item","onDeleteItem"]),W.pagination.total_pages>1?((0,o.wg)(),(0,o.j4)(Y,{key:2,pages:W.pagination,onChangePage:U.getCoupons},null,8,["pages","onChangePage"])):(0,o.kq)("",!0)],64)}const U={class:"modal fade",id:"couponModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},Z={class:"modal-dialog",role:"document"},L={class:"modal-content"},P=(0,o._)("div",{class:"modal-header bg-primary text-white"},[(0,o._)("h5",{class:"modal-title",id:"exampleModalLabel"},"優惠卷"),(0,o._)("input",{type:"button",value:"✕",class:"bg-transparent border-0 text-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Y={class:"modal-body"},q={class:"mb-3"},H=(0,o._)("label",{for:"title",class:"form-label"},[(0,o.Uk)("標題"),(0,o._)("span",{class:"text-danger"},"*")],-1),S={class:"mb-3"},j=(0,o._)("label",{for:"coupon_code",class:"form-label"},[(0,o.Uk)("優惠碼"),(0,o._)("span",{class:"text-danger"},"*")],-1),I={class:"mb-3"},K=(0,o._)("label",{for:"due_date",class:"form-label"},[(0,o.Uk)("到期日"),(0,o._)("span",{class:"text-danger"},"*")],-1),N={class:"mb-3"},T=(0,o._)("label",{for:"percent",class:"form-label"},[(0,o.Uk)("折扣百分比"),(0,o._)("span",{class:"text-danger"},"*")],-1),A={class:"mb-3 d-flex flex-column"},O={class:"form-label",for:"is_enabled"},B=(0,o.Uk)(" 啟用("),E={key:0},F={key:1},G=(0,o.Uk)(") "),J={class:"modal-footer"},Q=(0,o._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1);function R(e,t,a,n,i,d){const p=(0,o.up)("v-field"),c=(0,o.up)("error-message"),u=(0,o.up)("v-form");return(0,o.wg)(),(0,o.iD)("div",U,[(0,o._)("div",Z,[(0,o._)("div",L,[P,(0,o._)("div",Y,[(0,o.Wm)(u,null,{default:(0,o.w5)((({errors:e})=>[(0,o._)("div",q,[H,(0,o.Wm)(p,{type:"text",class:(0,s.C_)(["form-control",{"is-invalid":e["標題"]}]),id:"title",placeholder:"請輸入標題",modelValue:i.tempCoupon.title,"onUpdate:modelValue":t[0]||(t[0]=e=>i.tempCoupon.title=e),name:"標題",rules:"required"},null,8,["modelValue","class"]),(0,o.Wm)(c,{name:"標題",class:"invalid-feedback"})]),(0,o._)("div",S,[j,(0,o.Wm)(p,{type:"text",class:(0,s.C_)(["form-control",{"is-invalid":e["優惠代碼"]}]),id:"coupon_code",placeholder:"請輸入優惠碼",modelValue:i.tempCoupon.code,"onUpdate:modelValue":t[1]||(t[1]=e=>i.tempCoupon.code=e),name:"優惠代碼",rules:"required"},null,8,["modelValue","class"]),(0,o.Wm)(c,{name:"優惠代碼",class:"invalid-feedback"})]),(0,o._)("div",I,[K,(0,o.Wm)(p,{type:"date",class:(0,s.C_)(["form-control",{"is-invalid":e["到期日"]}]),id:"due_date",modelValue:i.due_date,"onUpdate:modelValue":t[2]||(t[2]=e=>i.due_date=e),name:"到期日",rules:"required"},null,8,["modelValue","class"]),(0,o.Wm)(c,{name:"到期日",class:"invalid-feedback"})]),(0,o._)("div",N,[T,(0,o.Wm)(p,{type:"number",class:(0,s.C_)(["form-control",{"is-invalid":e["折扣百分比"]}]),id:"percent",placeholder:"請輸入折扣百分比",modelValue:i.tempCoupon.percent,"onUpdate:modelValue":t[3]||(t[3]=e=>i.tempCoupon.percent=e),name:"折扣百分比",rules:"required"},null,8,["modelValue","class"]),(0,o.Wm)(c,{name:"折扣百分比",class:"invalid-feedback"})]),(0,o._)("div",A,[(0,o._)("label",O,[B,1===i.tempCoupon.is_enabled?((0,o.wg)(),(0,o.iD)("span",E,"是")):((0,o.wg)(),(0,o.iD)("span",F,"否")),G]),(0,o.wy)((0,o._)("input",{class:"form-check-input",type:"checkbox",id:"is_enabled","true-value":1,"false-value":0,"onUpdate:modelValue":t[4]||(t[4]=e=>i.tempCoupon.is_enabled=e)},null,512),[[l.e8,i.tempCoupon.is_enabled]])])])),_:1})]),(0,o._)("div",J,[Q,(0,o._)("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=t=>e.$emit("add-coupon",i.tempCoupon))},"確認 ")])])])],512)}var X=a(7995),ee={props:{coupon:{}},emits:["add-coupon"],watch:{coupon(){this.tempCoupon=this.coupon;const e=new Date(1e3*this.tempCoupon.due_date).toISOString().split("T");this.due_date=e[0]},due_date(){this.tempCoupon.due_date=Math.floor(new Date(this.due_date))/1e3}},data(){return{modal:{},tempCoupon:{},due_date:""}},mixins:[X.Z]},te=a(3744);const ae=(0,te.Z)(ee,[["render",R]]);var oe=ae,se=a(9946),le=a(2816),ne=a(7430),ie={components:{couponModal:oe,deleteModal:se.Z,pagination:le.Z},data(){return{coupons:[],tempCoupon:{},pagination:{},isNew:!1,isLoading:!1}},inject:["emitter"],mixins:[ne.Z],methods:{getCoupons(e=1){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/api/irenelee-api/admin/coupons?page=${e}`;this.$http.get(t).then((e=>{this.isLoading=!1,this.coupons=e.data.coupons,this.pagination=e.data.pagination,scrollTo(0,0)})).catch((e=>console.log(e.response)))},updateCoupon(e){if(this.tempCoupon=e,this.isNew){const e="https://vue3-course-api.hexschool.io/api/irenelee-api/admin/coupon";this.$http.post(e,{data:this.tempCoupon}).then((e=>{e.data.success?(this.getCoupons(),this.$message("success",e.data.message)):this.$message("danger","新增失敗")})).catch((e=>console.log(e.response))),this.$refs.showCouponModal.hideModal()}else{const e=`https://vue3-course-api.hexschool.io/api/irenelee-api/admin/coupon/${this.tempCoupon.id}`;this.$http.put(e,{data:this.tempCoupon}).then((e=>{e.data.success?(this.getCoupons(),this.$message("success","更新成功")):this.$message("danger","更新失敗")})).catch((e=>console.log(e.response))),this.$refs.showCouponModal.hideModal()}},openModal(e,t){"delete"===e?(this.tempCoupon={...t},this.$refs.showDeleteModal.showModal()):(this.tempCoupon="add"===e?{is_enabled:0,due_date:(new Date).getTime()/1e3}:{...t},this.$refs.showCouponModal.showModal())},deleteCoupon(){const e=`https://vue3-course-api.hexschool.io/api/irenelee-api/admin/coupon/${this.tempCoupon.id}`;this.$http.delete(e).then((e=>{e.data.success&&(this.getCoupons(),this.$message("success",e.data.message))})).catch((e=>console.log(e.response))),this.$refs.showDeleteModal.hideModal()}},created(){this.getCoupons()}};const de=(0,te.Z)(ie,[["render",W]]);var pe=de}}]);
//# sourceMappingURL=419.05a228d5.js.map